(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[236],{5327:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shell",function(){return __webpack_require__(6825)}])},9939:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AdbTerminal:function(){return AdbTerminal}});var _yume_chan_adb__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7417),_yume_chan_event__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2469),_yume_chan_stream_extra__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6261),xterm__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8425),xterm_addon_fit__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8711),xterm_addon_search__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2923),xterm_addon_webgl__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8874);class AdbTerminal extends _yume_chan_event__WEBPACK_IMPORTED_MODULE_1__.Xn{get socket(){return this._socket}set socket(value){if(this._socket){var ref;this.dispose(),null===(ref=this._socketAbortController)||void 0===ref||ref.abort()}if(this._socket=value,value){this.terminal.clear(),this.terminal.reset(),this._socketAbortController=new _yume_chan_stream_extra__WEBPACK_IMPORTED_MODULE_2__.HS,value.stdout.pipeTo(new _yume_chan_stream_extra__WEBPACK_IMPORTED_MODULE_2__.Vj({write:chunk=>{this.terminal.write(chunk)}}),{signal:this._socketAbortController.signal});let _writer=value.stdin.getWriter();this.addDisposable(this.terminal.onData(data=>{let buffer=(0,_yume_chan_adb__WEBPACK_IMPORTED_MODULE_0__.lz)(data);_writer.write(buffer)})),this.fit()}}setContainer(container){container.appendChild(this.element),this.terminal.element||(this.element.offsetWidth,this.terminal.open(this.element),this.terminal.loadAddon(new xterm_addon_webgl__WEBPACK_IMPORTED_MODULE_6__.WebglAddon),this.terminal.options.cursorBlink=!0,this.fit())}fit(){var ref;this.fitAddon.fit();let{rows,cols}=this.terminal;null===(ref=this._socket)||void 0===ref||ref.resize(rows,cols)}constructor(){super(),this.element=document.createElement("div"),this.terminal=new xterm__WEBPACK_IMPORTED_MODULE_3__.Terminal({allowProposedApi:!0,allowTransparency:!0,cursorStyle:"bar",cursorBlink:!0,fontFamily:'"Cascadia Code", Consolas, monospace, "Source Han Sans SC", "Microsoft YaHei"',letterSpacing:1,scrollback:9e3,smoothScrollDuration:50,overviewRulerWidth:20}),this.searchAddon=new xterm_addon_search__WEBPACK_IMPORTED_MODULE_5__.SearchAddon,this.fitAddon=new xterm_addon_fit__WEBPACK_IMPORTED_MODULE_4__.FitAddon,this.element.style.width="100%",this.element.style.height="100%",this.element.style.overflow="hidden",this.terminal.loadAddon(this.searchAddon),this.terminal.loadAddon(this.fitAddon)}}},6825:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";let terminal;__webpack_require__.r(__webpack_exports__);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4471),_fluentui_react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1887),_fluentui_react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(9899),_fluentui_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7162),_fluentui_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1197),_griffel_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9332),_griffel_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(8186),mobx__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6323),mobx_react_lite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6779),next_head__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3591),next_head__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(next_head__WEBPACK_IMPORTED_MODULE_2__),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3370);__webpack_require__(1714);var _components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4347),_state__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2344),_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(5155);let useClasses=(0,_griffel_react__WEBPACK_IMPORTED_MODULE_8__.Z)({count:{..._griffel_react__WEBPACK_IMPORTED_MODULE_9__.q5.padding("0","8px")}});{let{AdbTerminal}=__webpack_require__(9939);terminal=new AdbTerminal}let SEARCH_OPTIONS={decorations:{matchBackground:"#42557b",matchOverviewRuler:"#d18616",activeMatchBackground:"#6199ff2f",activeMatchColorOverviewRuler:"#d186167e"}},state=(0,mobx__WEBPACK_IMPORTED_MODULE_10__.ky)({visible:!1,index:void 0,count:void 0,setVisible(value){this.visible=value},searchKeyword:"",setSearchKeyword(value){this.searchKeyword=value,terminal.searchAddon.findNext(value,{...SEARCH_OPTIONS,incremental:!0})},searchPrevious(){terminal.searchAddon.findPrevious(this.searchKeyword,SEARCH_OPTIONS)},searchNext(){terminal.searchAddon.findNext(this.searchKeyword,SEARCH_OPTIONS)}},{searchPrevious:mobx__WEBPACK_IMPORTED_MODULE_10__.aD.bound,searchNext:mobx__WEBPACK_IMPORTED_MODULE_10__.aD.bound});terminal&&terminal.searchAddon.onDidChangeResults(e=>{console.log(e),(0,mobx__WEBPACK_IMPORTED_MODULE_10__.z)(()=>{e?(state.index=e.resultIndex,state.count=e.resultCount):(state.index=void 0,state.count=void 0)})}),(0,mobx__WEBPACK_IMPORTED_MODULE_10__.EH)(()=>{if(terminal){if(!_state__WEBPACK_IMPORTED_MODULE_6__.q.device){terminal.socket=void 0;return}!terminal.socket&&state.visible&&_state__WEBPACK_IMPORTED_MODULE_6__.q.device.subprocess.shell().then((0,mobx__WEBPACK_IMPORTED_MODULE_10__.aD)(shell=>{terminal.socket=shell}),e=>{_state__WEBPACK_IMPORTED_MODULE_6__.q.showErrorDialog(e)})}});let UpIconProps={iconName:_utils__WEBPACK_IMPORTED_MODULE_7__.PJ.ChevronUp},DownIconProps={iconName:_utils__WEBPACK_IMPORTED_MODULE_7__.PJ.ChevronDown},Shell=()=>{let classes=useClasses(),handleSearchKeywordChange=(0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)((e,value)=>{state.setSearchKeyword(null!=value?value:"")},[]),handleResize=(0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(()=>{terminal.fit()},[]),handleContainerRef=(0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(container=>{container&&terminal.setContainer(container)},[]);return(0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>(state.setVisible(!0),()=>{state.setVisible(!1)}),[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_11__.K,{..._utils__WEBPACK_IMPORTED_MODULE_7__.LE,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_head__WEBPACK_IMPORTED_MODULE_2___default(),{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("title",{children:"Interactive Shell"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_11__.K,{horizontal:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{grow:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_13__.R,{placeholder:"Find",value:state.searchKeyword,onChange:handleSearchKeywordChange,onSearch:state.searchNext})}),0===state.count?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{className:classes.count,align:"center",children:"No results"}):void 0!==state.count?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{className:classes.count,align:"center",children:[state.index+1," of ",state.count]}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_14__.h,{disabled:!state.searchKeyword,iconProps:UpIconProps,onClick:state.searchPrevious})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_14__.h,{disabled:!state.searchKeyword,iconProps:DownIconProps,onClick:state.searchNext})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.v,{grow:!0,styles:{root:{position:"relative",minHeight:0}},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components__WEBPACK_IMPORTED_MODULE_5__.do,{onResize:handleResize}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{ref:handleContainerRef,style:{height:"100%"}})]})]})};__webpack_exports__.default=(0,mobx_react_lite__WEBPACK_IMPORTED_MODULE_1__.Pi)(Shell)}},function(__webpack_require__){__webpack_require__.O(0,[470,447,774,888,179],function(){return __webpack_require__(__webpack_require__.s=5327)}),_N_E=__webpack_require__.O()}]);
//# sourceMappingURL=shell-c9fa156c14813ca1.js.map