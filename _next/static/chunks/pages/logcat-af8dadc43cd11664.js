(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[793],{1481:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/logcat",function(){return __webpack_require__(7428)}])},7428:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return logcat}});var jsx_runtime=__webpack_require__(4471),Stack=__webpack_require__(1887),Checkbox=__webpack_require__(8439),StackItem=__webpack_require__(9899),makeStyles_esm=__webpack_require__(9332),index_esm=__webpack_require__(8186),mergeClasses_esm=__webpack_require__(3423),esm=__webpack_require__(7386);function insert(array,length,value,index){index!==length&&array.set(array.subarray(index,length),index+1),array[index]=value}function remove(array,length,index){index<length-1&&array.set(array.subarray(index+1,length),index)}class BTreeNode{order;mid;minKeyCount;keys;keyCount;height;children;constructor(order,keys,keyCount,height,children){this.order=order,this.mid=this.order>>1,this.minKeyCount=(this.order+1>>1)-1,this.keys=keys,this.keyCount=keyCount,this.height=height,this.children=children}split(value,index,child){let middleKey,rightChildren;let rightKeys=new Int32Array(this.order-1);return index<this.mid?(middleKey=this.keys[this.mid-1],rightKeys.set(this.keys.subarray(this.mid),0),insert(this.keys,this.mid-1,value,index),child?(rightChildren=this.children.splice(this.mid,this.order-this.mid),this.children.splice(index+1,0,child)):rightChildren=Array(this.order)):(index===this.mid?(middleKey=value,rightKeys.set(this.keys.subarray(this.mid),0)):(middleKey=this.keys[this.mid],index!==this.mid+1&&rightKeys.set(this.keys.subarray(this.mid+1,index),0),rightKeys[index-this.mid-1]=value,rightKeys.set(this.keys.subarray(index),index-this.mid)),child?(rightChildren=this.children.splice(this.mid+1,this.order-this.mid-1)).splice(index-this.mid,0,child):rightChildren=Array(this.order)),this.keyCount=this.mid,{key:middleKey,child:new BTreeNode(this.order,rightKeys,this.order-1-this.mid,this.height,rightChildren)}}search(value){let start=0,end=this.keyCount-1;for(;start<=end;){let mid=start+end>>1;if(this.keys[mid]===value)return mid;this.keys[mid]<value?start=mid+1:end=mid-1}return~start}has(value){let index=this.search(value);return index>=0||this.height>0&&(index=~index,this.children[index].has(value))}add(value){let index=this.search(value);if(index>=0)return!1;if(index=~index,0===this.height)return this.keyCount===this.order-1?this.split(value,index):(insert(this.keys,this.keyCount,value,index),this.keyCount+=1,!0);let split=this.children[index].add(value);if("object"==typeof split){if(this.keyCount===this.order-1)return this.split(split.key,index,split.child);insert(this.keys,this.keyCount,split.key,index),this.keyCount+=1,this.children.splice(index+1,0,split.child)}return!0}delete(value){let index=this.search(value);if(index>=0)return this.deleteAt(index),!0;if(this.height>0){index=~index;let deleted=this.children[index].delete(value);return deleted&&this.balance(index),deleted}return!1}max(){return 0===this.height?this.keys[this.keyCount-1]:this.children[this.keyCount].max()}balance(index){let child=this.children[index];if(child.keyCount>=this.minKeyCount)return;if(index>0){let left=this.children[index-1];if(left.keyCount>this.minKeyCount){insert(child.keys,child.keyCount,this.keys[index-1],0),this.height>1&&child.children.splice(0,0,left.children[left.keyCount]),child.keyCount+=1,this.keys[index-1]=left.keys[left.keyCount-1],left.keyCount-=1;return}if(left.keys[left.keyCount]=this.keys[index-1],left.keyCount+=1,left.keys.set(child.keys.subarray(0,child.keyCount),left.keyCount),this.height>1)for(let i=0;i<=child.keyCount;i++)left.children[left.keyCount+i]=child.children[i];left.keyCount+=child.keyCount,remove(this.keys,this.keyCount,index-1),this.children.splice(index,1),this.keyCount-=1;return}let right=this.children[index+1];if(right.keyCount>this.minKeyCount){child.keys[child.keyCount]=this.keys[index],this.height>1&&(child.children[child.keyCount+1]=right.children.splice(0,1)[0]),child.keyCount+=1,this.keys[index]=right.keys[0],remove(right.keys,right.keyCount,0),right.keyCount-=1;return}if(child.keys[child.keyCount]=this.keys[index],child.keyCount+=1,child.keys.set(right.keys.subarray(0,right.keyCount),child.keyCount),this.height>1)for(let i1=0;i1<=right.keyCount;i1++)child.children[child.keyCount+i1]=right.children[i1];child.keyCount+=right.keyCount,remove(this.keys,this.keyCount,index),this.children.splice(index+1,1),this.keyCount-=1}deleteMax(){if(0===this.height){this.keyCount-=1;return}let child=this.children[this.keyCount];child.deleteMax(),this.balance(this.keyCount)}deleteAt(index){if(0===this.height){remove(this.keys,this.keyCount,index),this.keyCount-=1;return}let max=this.children[index].max();this.keys[index]=max,this.children[index].deleteMax(),this.balance(index)}*[Symbol.iterator](){if(this.height>0){for(let i=0;i<this.keyCount;i+=1)yield*this.children[i],yield this.keys[i];yield*this.children[this.keyCount]}else for(let i1=0;i1<this.keyCount;i1+=1)yield this.keys[i1]}}class BTree{order;root;size=0;constructor(order){this.order=order,this.root=new BTreeNode(order,new Int32Array(order-1),0,0,Array(order))}has(value){let node=this.root;for(;;){let index=node.search(value);if(index>=0)return!0;if(!(node=node.children[~index]))return!1}}add(value){let split=this.root.add(value);if("object"==typeof split){let keys=new Int32Array(this.order-1);keys[0]=split.key;let children=Array(this.order);children[0]=this.root,children[1]=split.child,this.root=new BTreeNode(this.order,keys,1,this.root.height+1,children)}return split&&(this.size+=1),!!split}delete(value){let deleted=this.root.delete(value);return deleted&&(this.root.height>0&&0===this.root.keyCount&&(this.root=this.root.children[0]),this.size-=1),deleted}clear(){this.root.keyCount=0,this.root.height=0,this.root.children=Array(this.order),this.size=0}[Symbol.iterator](){return this.root[Symbol.iterator]()}}var stream_extra_esm=__webpack_require__(6261),mobx_esm=__webpack_require__(6323),es=__webpack_require__(6779),head=__webpack_require__(3591),head_default=__webpack_require__.n(head),react=__webpack_require__(3370),components=__webpack_require__(4347),state=__webpack_require__(2344),utils=__webpack_require__(5155);let useClasses=(0,makeStyles_esm.Z)({grid:{height:"100%",marginLeft:"-16px",marginRight:"-16px"},header:{textAlign:"center",lineHeight:"".concat(32,"px")},row:{"&:hover":{backgroundColor:"#f3f2f1"}},selected:{backgroundColor:"#edebe9"},code:{fontFamily:"monospace",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:"32px",cursor:"default",...index_esm.q5.overflow("hidden")}}),logcat_state=(0,mobx_esm.ky)({logcat:void 0,running:!1,buffer:[],flushRequested:!1,list:[],selection:new BTree(6),count:0,stream:void 0,stopSignal:void 0,selectedCount:0,animationFrameId:void 0,start(){this.running||(this.list=[],this.running=!0,this.stream=this.logcat.binary(),this.stopSignal=new stream_extra_esm.HS,this.stream.pipeTo(new stream_extra_esm.Vj({write:chunk=>{this.buffer.push(chunk),this.flushRequested||(this.flushRequested=!0,requestAnimationFrame(this.flush))}}),{signal:this.stopSignal.signal}).catch(()=>{}))},flush(){this.list.push(...this.buffer),this.buffer=[],this.flushRequested=!1},stop(){this.running=!1,this.stopSignal.abort()},clear(){this.list=[],this.selection.clear(),this.selectedCount=0},get empty(){return 0===this.list.length},get commandBar(){return[this.running?{key:"stop",text:"Stop",iconProps:{iconName:utils.PJ.Stop},onClick:()=>this.stop()}:{key:"start",text:"Start",disabled:void 0===this.logcat,iconProps:{iconName:utils.PJ.Play},onClick:()=>this.start()},{key:"clear",text:"Clear",disabled:this.empty,iconProps:{iconName:utils.PJ.Delete},onClick:()=>this.clear()},{key:"copyAll",text:"Copy Rows",disabled:0===this.selectedCount,iconProps:{iconName:utils.PJ.Copy},onClick:()=>{let text="";for(let index of this.selection)text+=(0,esm.oo)(this.list[index],esm.vj.Brief)+"\n";text=text.replace(/\u0000/g,""),navigator.clipboard.writeText(text)}},{key:"copyText",text:"Copy Messages",disabled:0===this.selectedCount,iconProps:{iconName:utils.PJ.Copy},onClick:()=>{let text="";for(let index of this.selection)text+=this.list[index].message+"\n";text=text.replace(/\u0000/g,""),navigator.clipboard.writeText(text)}}]},get columns(){return[{width:40,title:"",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,[checked,setChecked]=(0,react.useState)(!1);(0,react.useEffect)(()=>{setChecked(this.selection.has(rowIndex))},[rowIndex]);let handleChange=(0,utils.R9)((e,checked)=>{void 0!==checked&&(checked?(this.selection.add(rowIndex),setChecked(!0)):(this.selection.delete(rowIndex),setChecked(!1)),(0,mobx_esm.z)(()=>{this.selectedCount=this.selection.size}))});return(0,jsx_runtime.jsx)(Stack.K,{className:className,verticalAlign:"center",horizontalAlign:"center",...rest,children:(0,jsx_runtime.jsx)(Checkbox.X,{checked:checked,onChange:handleChange})})}},{width:200,title:"Time",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex];item.timeString||(item.timeString=new Date(1e3*item.second).toISOString());let classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:item.timeString})}},{width:60,title:"PID",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex],classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:item.pid})}},{width:60,title:"TID",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex],classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:item.tid})}},{width:80,title:"Priority",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex],classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:esm.As[item.priority]})}},{width:300,title:"Tag",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex],classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:item.tag})}},{width:300,flexGrow:1,title:"Message",CellComponent:param=>{let{rowIndex,columnIndex,className,...rest}=param,item=this.list[rowIndex],classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(classes.code,className),...rest,children:item.message})}}]}},{buffer:!1,list:mobx_esm.LO.shallow,flush:mobx_esm.aD.bound});(0,mobx_esm.EH)(()=>{state.q.device?(0,mobx_esm.z)(()=>{logcat_state.logcat=new esm.J(state.q.device)}):(0,mobx_esm.z)(()=>{logcat_state.logcat=void 0,logcat_state.running&&logcat_state.stop()})});let Header=(0,es.Pi)(function(param){let{className,columnIndex,...rest}=param,classes=useClasses();return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(className,classes.header),...rest,children:logcat_state.columns[columnIndex].title})}),Row=function(param){let{className,rowIndex,...rest}=param;logcat_state.list[rowIndex];let classes=useClasses(),handleClick=(0,utils.R9)(()=>{(0,mobx_esm.z)(()=>{})});return(0,jsx_runtime.jsx)("div",{className:(0,mergeClasses_esm.z)(className,classes.row),onClick:handleClick,...rest})},LogcatPage=()=>{let classes=useClasses();return(0,jsx_runtime.jsxs)(Stack.K,{...utils.LE,children:[(0,jsx_runtime.jsx)(head_default(),{children:(0,jsx_runtime.jsx)("title",{children:"Logcat - Android Web Toolbox"})}),(0,jsx_runtime.jsx)(components.X3,{items:logcat_state.commandBar}),(0,jsx_runtime.jsx)(StackItem.v,{grow:!0,children:(0,jsx_runtime.jsx)(components.rj,{className:classes.grid,rowCount:logcat_state.list.length,rowHeight:32,columns:logcat_state.columns,HeaderComponent:Header,RowComponent:Row})})]})};var logcat=(0,es.Pi)(LogcatPage)}},function(__webpack_require__){__webpack_require__.O(0,[774,888,179],function(){return __webpack_require__(__webpack_require__.s=1481)}),_N_E=__webpack_require__.O()}]);
//# sourceMappingURL=logcat-af8dadc43cd11664.js.map